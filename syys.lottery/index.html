<!DOCTYPE html>

<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <script type="text/javascript" src="./jquery.min.js"></script>
    <script type="text/javascript" src="./osql.js"></script>

    <script>
        osql.requireLogin();

        async function buttonPressed(){
            var me = await osql.getMe();
            console.log(me);

            x = document.getElementById('type');
            if (x =='administer'){
                sessionStorage.setItem('playerId', me.id);
                sessionStorage.setItem('name', me.lname);
                location.href = 'admin1.html';
            }else{
                var sql = `Insert ignore into Players (Player_id, Player_name) values("${me.id}", "${me.lname}");`;//Playerに自分の情報を追加
                var objects_1 = await osql.connect(sql);
                sessionStorage.setItem('playerId', me.id);
                sessionStorage.setItem('name', me.lname);
                location.href = 'lottery_player.html';
            }            
        }

    </script>

</head>

<body>
    <h1>トップページ</h1>
    <div>
        <button onclick="buttonPressed()">ログイン</button>
    </div>
    <div>
        <select id="type">
            <option value="administer">管理者</option>
            <option value="player">参加者</option>
        </select>
    </div>

</body>

</html>